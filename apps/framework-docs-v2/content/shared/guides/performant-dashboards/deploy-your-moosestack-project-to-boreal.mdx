### Deploy your MooseStack project to Boreal

This guide uses Boreal to manage deployment of your MooseStack project to production.

<BulletPointsCard
  title="Why set up Boreal now?"
  bulletStyle="check"
  bullets={[
    {
      title: "Preview Environments and Migration Planning",
      description:
        "When you open a feature branch and PR later in this guide, Boreal can automatically provision a preview environment and generate a migration plan for the code changes in your branch. This ensures your code changes are safe and you can apply them to your main ClickHouse database with confidence.",
    },
  ]}
/>

<GuideStepper id="deploy-your-moosestack-project-to-boreal-steps" persist>
<GuideStepper.Step id="deploy-your-moosestack-project-to-boreal-step-1" number={1} title="Create New Boreal Project" summary="Set up a Boreal project connected to your repository and configure environments for deployment.">
<GuideStepper.WhatYouNeed>
- Access to your GitHub repository and Boreal account
- The MooseStack project root path in your repository
- Optional ClickHouse connection details if using your own instance
</GuideStepper.WhatYouNeed>
<GuideStepper.WhatYouGet>
- A Boreal project connected to your repository
- A baseline deployment environment for main + preview branches
- A ClickHouse HTTPS connection string for the next guide section
</GuideStepper.WhatYouGet>

<GuideStepper.Checkpoint title="Create New Boreal Project">
Go to [boreal.cloud](https://boreal.cloud) and sign in to your account. If you don't have an account, click the `Sign Up` button to create one.

<Callout
  type="info"
  title="Don't have a Boreal account?"
  ctaLabel="Sign Up"
  href="https://boreal.cloud/sign-up"
>
  If you don't have a Boreal account, go to [boreal.cloud](https://boreal.cloud)
  and sign up for an account. Once you're signed up, you'll land on the
  `Projects` page.
</Callout>

From your account dashboard, click the `New Project` button to create a new project.

</GuideStepper.Checkpoint>

<GuideStepper.Checkpoint title="Define project details">
![Project Details](/deployment/import-existing-project.png)

On the “Import Existing Project” page, confirm the basic settings Boreal will use to build and deploy this repo:

- `Name`: this field should contain the desired project name. By default it shows the repository name; update it if necessary.

- `Project Root`: set the directory within the repository that contains your MooseStack project (for example, the folder that contains your Moose config like `project.toml`). If this is a monorepo, make sure you pick the specific subfolder for the app you’re deploying (e.g., `moosestack/`).

Once these fields look correct, click `Next` to proceed.

</GuideStepper.Checkpoint>

<GuideStepper.Checkpoint title="Connect to your ClickHouse instance">
**Only do this if you are connecting to your own ClickHouse instance.**

![Configure ClickHouse Connection](/deployment/configure-clickhouse-connection.png)

By default, Boreal provisions a managed ClickHouse instance for your project. If you already have one, provide its connection details to use it instead.

Required connection details:

- `Host` (e.g., your-instance.clickhouse.cloud)
- `Port` (for ClickHouse Cloud this is commonly 8443)
- `Username` (e.g. `default`)
- `Password` (your ClickHouse password)
- `Connection Name` (e.g., “Prod ClickHouse Cloud”) for reference

<Callout type="info" title="Admin Role Required">
  `Username`/`Password` must have the `admin` role to automatically create
  preview databases for branches in your GitHub repo.
</Callout>

Test the connection before continuing. If it fails, fix the connection details
and test again.

</GuideStepper.Checkpoint>

<GuideStepper.Checkpoint title="Set the main branch target database">

**Only do this if you’re connecting your own ClickHouse instance.** Set the
database name Boreal should use for your project’s main branch.

![Set Main Branch](/deployment/set-main-db.png)

By default, Boreal creates a new database for your project. This is the database where schema changes will be applied when you merge to your main GitHub branch.

<ConditionalContent whenId="source-database" whenValue="postgres">
Override this by selecting the ClickHouse Cloud database your ClickPipes write to.

<Callout
  type="info"
  title="Boreal + ClickPipes: what Moose will (and won’t) change"
>
  ClickPipes owns the raw replicated tables, so Boreal will not rewrite them
  when you deploy unless you remove
  `OlapTable.lifeCycle = LifeCycle.EXTERNALLY_MANAGED`. In this guide, you add
  Moose-managed resources (views, materialized views, serving tables), and
  Boreal migrates them automatically during deployment.
</Callout>
</ConditionalContent>

</GuideStepper.Checkpoint>

<GuideStepper.Checkpoint title="Complete deployment">
Click `Deploy` to run the initial build and create the first deployment for this repo. This will redirect you to the `Deployments` page. Typically, it will take around 1-2 minutes to deploy.

Once the deployment completes, you’ll be redirected to the project overview page.

</GuideStepper.Checkpoint>

<GuideStepper.Checkpoint title="Save your ClickHouse connection string">
For the next section, you will need to copy the ClickHouse HTTPS connection string. You can locate this by clicking on the `Database` button in the top right corner of your project overview dashboard, and then copying the ClickHouse HTTPS connection string located at the bottom of the panel.

![Copy Connection String](/deployment/copy-connection-string.png)

</GuideStepper.Checkpoint>

</GuideStepper.Step>
</GuideStepper>
