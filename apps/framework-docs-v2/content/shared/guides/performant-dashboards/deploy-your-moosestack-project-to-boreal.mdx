### Deploy your MooseStack project to Boreal

This guide uses Boreal to manage deployment of your MooseStack project to production.

<BulletPointsCard
  title="Why set up Boreal now?"
  bulletStyle="check"
  bullets={[
    {
      title: "Preview Environments and Migration Planning",
      description:
        "When you open a feature branch and PR later in this guide, Boreal can automatically provision a preview environment and generate a migration plan for the code changes in your branch. This ensures your code changes are safe and you can apply them to your main ClickHouse database with confidence.",
    },
  ]}
/>

#### Step 1: Create New Boreal Project

Go to [boreal.cloud](https://boreal.cloud) and sign in to your account. If you don't have an account, click the `Sign Up` button to create one.

<Callout
  type="info"
  title="Don't have a Boreal account?"
  ctaLabel="Sign Up"
  href="https://boreal.cloud/sign-up"
>
  If you don't have a Boreal account, go to [boreal.cloud](https://boreal.cloud)
  and sign up for an account. Once you're signed up, you'll land on the
  `Projects` page.
</Callout>

From your account dashboard, click the `New Project` button to create a new project.

#### Step 2: Define project details

![Project Details](/deployment/import-existing-project.png)

On the “Import Existing Project” page, confirm the basic settings Boreal will use to build and deploy this repo:

- `Name`: this field should contain the desired project name. By default it shows the repository name; update it if necessary.

- `Project Root`: set the directory within the repository that contains your MooseStack project (for example, the folder that contains your Moose config like `project.toml`). If this is a monorepo, make sure you pick the specific subfolder for the app you’re deploying (e.g., `moosestack/`).

Once these fields look correct, click `Next` to proceed.

#### Step 3: Select data services

![Select Data Services](/deployment/configure-data-services.png)

The next screen configures the data services your deploys will use. In practice, this sets:

- where main-branch deployments apply schema changes, and
- where pull-request preview environments provision isolated databases.

You can accept the default managed services, or connect existing infrastructure.

<ConditionalContent whenId="source-database" whenValue="postgres">
Since you are using ClickHouse Cloud, select `Customize` to connect to your existing ClickHouse Cloud instance.

#### Step 4: Configure ClickHouse connection

![Configure ClickHouse Connection](/deployment/configure-clickhouse-connection.png)

If you chose `Customize`, open the ClickHouse configuration and select `Connect to existing ClickHouse instance`. Then fill out the form:

- `Host`: enter the hostname of your ClickHouse instance (e.g., your-instance.clickhouse.cloud).
- `Port`: specify the port number (for ClickHouse Cloud this is commonly 8443).
- `User & Password`: supply the credentials for your ClickHouse user.

<Callout type="info" title="Admin Role Required">
  This user must have the `admin` role. This is required in order to create
  preview database instances for each preview environment.
</Callout>
- `Connection Name`: give this connection an identifiable name (e.g., “Prod
ClickHouse Cloud”) for future reference.

Click `Test Connection` to verify connectivity. If the test fails, fix the connection details before continuing.

If you intend to use this connection for other projects, toggle `Use as Default`.

Finally, click `Add connection` to finish the setup.

#### Step 5: Set the main-branch database target

![Set Main Branch](/deployment/set-main-db.png)

Next, choose the database that `main` branch deployments should target. This is the primary ClickHouse database your MooseStack-defined resources will live in: when you merge changes into your repository’s main branch, schema changes will be applied here.

<Callout
  type="info"
  title="Boreal + ClickPipes: what Moose will (and won’t) change"
>
  If you're using ClickPipes, the replicated raw tables in ClickHouse are
  created and managed by ClickPipes. Moose (and Boreal) creates and migrates
  **Moose-defined** ClickHouse resources (views, materialized views, serving
  tables) alongside them—Moose does not rewrite or manage ClickPipes-owned
  tables. In your MooseStack project, model ClickPipes-owned tables as
  `EXTERNALLY_MANAGED` in a dedicated file like
  `app/clickpipesExternalModels.ts` (generated via `moose db pull`).
</Callout>

In the database selector, choose the database you created in ClickHouse Cloud (the same one your CDC pipeline will write into).

</ConditionalContent>

#### Complete deployment

Click `Deploy` to run the initial build and create the first deployment for this repo. This will redirect you to the `Deployments` page. Typically, it will take around 1-2 minutes to deploy.

Once the deployment completes, you’ll be redirected to the project overview page.

For the next section, you will need to copy the ClickHouse HTTPS connection string. You can locate this by clicking on the `Database` button in the top right corner of your project overview dashboard, and then copying the ClickHouse HTTPS connection string located at the bottom of the panel.

![Copy Connection String](/deployment/copy-connection-string.png)
