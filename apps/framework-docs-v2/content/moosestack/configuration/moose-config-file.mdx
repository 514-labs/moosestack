---
title: moose.config.toml
description: Reference documentation for the moose.config.toml file
order: 30
---

import { Callout } from "@/components/mdx";

# moose.config.toml Reference

The `moose.config.toml` file is the structured configuration file for your Moose project. It resides in the project root and defines defaults for services, feature flags, and project metadata.

<Callout type="info" title="Primary Configuration Method">
This file is the primary way to configure Moose infrastructure including ClickHouse, Redpanda, Redis, Temporal, and HTTP servers.

Do not use docker-compose overrides to modify Moose-managed services. See [Dev Environment](/moosestack/configuration/dev-environment) for guidelines on when to use docker-compose extensions.
</Callout>

## Project Configuration

Configure top-level project settings.

```toml
# Programming language used in the project (`Typescript` or `Python`)
language = "Typescript"

# Custom source directory path (Default: "app")
# source_dir = "app"

# Whether to load infrastructure containers (ClickHouse, Redpanda, Redis, etc.) in dev mode
# Set to false if you are connecting to external infrastructure exclusively
# load_infra = true

# Map of supported old versions and their locations (Default: {})
# supported_old_versions = { "0.1.0" = "path/to/old/version" }

# TypeScript-specific configuration
[typescript_config]
# Package manager to use (npm, pnpm, yarn) (Default: "npm")
package_manager = "npm"
```

## Telemetry Configuration

The `telemetry` section is used to configure telemetry for the project.

```toml
[telemetry]
# Whether telemetry collection is enabled
enabled = true
# Whether to export metrics to external systems
export_metrics = true
# Flag indicating if the user is a Moose developer
is_moose_developer = false
```

## Infrastructure Configuration

### Redpanda Configuration

The `redpanda_config` section is used to configure Redpanda for the project.

```toml
[redpanda_config]
# Broker connection string (e.g., "host:port") (Default: "localhost:19092")
broker = "localhost:19092"
# Confluent Schema Registry URL (optional)
# schema_registry_url = "http://localhost:8081"
# Message timeout in milliseconds (Default: 1000)
message_timeout_ms = 1000
# Default retention period in milliseconds (Default: 30000)
retention_ms = 30000
# Replication factor for topics (Default: 1)
replication_factor = 1
# SASL username for authentication (Default: None)
# sasl_username = "user"
# SASL password for authentication (Default: None)
# sasl_password = "password"
# SASL mechanism (e.g., "PLAIN", "SCRAM-SHA-256") (Default: None)
# sasl_mechanism = "PLAIN"
# Security protocol (e.g., "SASL_SSL", "PLAINTEXT") (Default: None)
# security_protocol = "SASL_SSL"
# Namespace for topic isolation (Default: None)
# namespace = "my_namespace"
```

### ClickHouse Configuration

The `clickhouse_config` section is used to configure ClickHouse for the project.

```toml
[clickhouse_config]
# Database name (Default: "local")
db_name = "local"
# ClickHouse user (Default: "panda")
user = "panda"
# ClickHouse password (Default: "pandapass")
password = "pandapass"
# Whether to use SSL for connection (Default: false)
use_ssl = false
# ClickHouse host (Default: "localhost")
host = "localhost"
# ClickHouse HTTP port (Default: 18123)
host_port = 18123
# ClickHouse native protocol port (Default: 9000)
native_port = 9000
# Optional host path to mount as the ClickHouse data volume (uses Docker volume if None) (Default: None)
# host_data_path = "/path/on/host/clickhouse_data"
# Optional list of additional databases to create on startup (Default: [])
# additional_databases = ["analytics", "staging"]

# ClickHouse cluster configuration for replicated tables (optional)
# Define clusters for use with ON CLUSTER DDL operations and distributed tables
# In local dev, Moose creates single-node clusters. In production, names must match your ClickHouse remote_servers config.
#
# Note: Cluster names are deployment directives that control HOW Moose runs DDL (via ON CLUSTER),
# not schema properties. Changing cluster names in your table configs won't trigger table recreation.
# [[clickhouse_config.clusters]]
# name = "default"
# [[clickhouse_config.clusters]]
# name = "my_cluster"
```

### HTTP Server Configuration

The `http_server_config` section is used to configure the HTTP server for the project.

```toml
[http_server_config]
# Host to bind the webserver to (Default: "localhost")
host = "localhost"
# Port for the main API server (Default: 4000)
port = 4000
# Port for the management server (Default: 5001)
management_port = 5001
# Optional path prefix for all routes (Default: None)
# path_prefix = "api"
# Number of worker processes for consumption API cluster (TypeScript only) (Default: Auto-calculated - 70% of CPU cores)
# Python projects always use 1 worker regardless of this setting
# api_workers = 2
# Script to run once on first start (Default: None)
# on_first_start_script = "echo 'Server started'"
# Script to run after every reload completes (Default: None)
# on_reload_complete_script = "echo 'Reload complete'"
```

### Redis Configuration

The `redis_config` section is used to configure Redis for the project.

```toml
# Redis configuration
# Note: You can configure Redis using either the `url` field OR the individual fields (hostname, port, tls).
# The `url` field takes precedence if both are set.
[redis_config]
# Redis connection URL (Default: "redis://127.0.0.1:6379")
url = "redis://127.0.0.1:6379"
# Namespace prefix for all Redis keys (Default: "MS")
key_prefix = "MS"
# Redis hostname (Default: "127.0.0.1")
# hostname = "127.0.0.1"
# Redis port (Default: 6379)
# port = 6379
# Whether to use TLS (Default: false)
# tls = false
```

### State Storage Configuration

The `state_config` section is used to configure the state storage for the project.

```toml
[state_config]
# Storage backend: "clickhouse" (default) or "redis"
# - "clickhouse": Store state in ClickHouse _MOOSE_STATE table (requires KeeperMap)
# - "redis": Store state in Redis (best for existing Redis infra or multi-tenant setups)
storage = "clickhouse"
```

### Temporal Configuration

The `temporal_config` section is used to configure Temporal for the project.

```toml
[temporal_config]
# Temporal database user (Default: "temporal")
db_user = "temporal"
# Temporal database password (Default: "temporal")
db_password = "temporal"
# Temporal database port (Default: 5432)
db_port = 5432
# Temporal server host (Default: "localhost")
temporal_host = "localhost"
# Temporal server port (Default: 7233)
temporal_port = 7233
# Temporal server scheme - "http" or "https" (Default: auto-detect based on host)
# temporal_scheme = "https"
# Temporal server version (Default: "1.27")
temporal_version = "1.27"
# Temporal admin tools version (Default: "1.27")
admin_tools_version = "1.27"
# Temporal UI version (Default: "2.37.0")
ui_version = "2.37.0"
# Temporal UI port (Default: 8080)
ui_port = 8080
# Temporal UI CORS origins (Default: "http://localhost:3000")
ui_cors_origins = "http://localhost:3000"
# Temporal dynamic config path (Default: "config/dynamicconfig/development-sql.yaml")
config_path = "config/dynamicconfig/development-sql.yaml"
# PostgreSQL version for Temporal database (Default: "13")
postgresql_version = "13"
# Path to Temporal client certificate (mTLS) (Default: "")
client_cert = ""
# Path to Temporal client key (mTLS) (Default: "")
client_key = ""
# Path to Temporal CA certificate (mTLS) (Default: "")
ca_cert = ""
# API key for Temporal Cloud connection (Default: "")
api_key = ""
# Temporal namespace (Default: "default")
namespace = "default"
# Temporal Cloud region (Default: "us-west1")
temporal_region = "us-west1"
```

### Git Configuration

The `git_config` section is used to configure Git integration.

```toml
[git_config]
# Name of the main branch (Default: "main")
main_branch_name = "main"
```

## Authentication

### JWT Configuration

The `jwt` section is used to configure JSON Web Token (JWT) authentication for APIs.

```toml
[jwt]
# Enforce JWT on all consumption APIs (Default: false)
enforce_on_all_consumptions_apis = false
# Enforce JWT on all ingestion APIs (Default: false)
enforce_on_all_ingest_apis = false
# Secret key for JWT signing (Required if jwt section is present)
# secret = "your-jwt-secret"
# JWT issuer (Required if jwt section is present)
# issuer = "your-issuer-name"
# JWT audience (Required if jwt section is present)
# audience = "your-audience-name"
```

### General Authentication

The `authentication` section is used for general authentication settings.

```toml
[authentication]
# Optional hashed admin API key for auth (Default: None)
# admin_api_key = "hashed_api_key"
```

## Feature Flags & Migrations

### Feature Flags

The `features` section is used to enable or disable specific Moose capabilities.

```toml
[features]
# Enable the streaming engine (Default: true)
streaming_engine = true
# Enable Temporal workflows (Default: false)
workflows = false
# Enable OLAP database (Default: true)
olap = true
# Enable Analytics APIs server (Default: true)
apis = true
# Enable data model V2 (Default: false)
data_model_v2 = false
# Enable DDL plan execution (Default: false)
ddl_plan = false
```

### Migration Configuration

The `migration_config` section is used to control migration behavior.

```toml
[migration_config]
# Operations to ignore during migration plan generation and drift detection
# Useful for managing TTL changes outside of Moose or when you don't want
# migration failures due to TTL drift
# ignore_operations = ["ModifyTableTtl", "ModifyColumnTtl"]
```
