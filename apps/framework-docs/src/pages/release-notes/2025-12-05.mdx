---
title: December 5, 2025
description: Release notes for December 5, 2025
---

import { Callout } from "@/components";

# December 5, 2025

Flexible Streaming Ingest, Web App Integration, and Infra Visibility Upgrades. This two-week release pushes MooseStack forward on three fronts: flexible high-volume ingestion, developer experience for full-stack apps, and operational visibility.

Moose gained the ability to handle arbitrary JSON ingest, Kafka-backed streaming, IcebergS3 for data lake integration, and powerful modeling tools like materialized columns, per-column codecs, and custom PRIMARY KEY expressions. On the app side, new Fastify and Next.js patterns—plus Python LSP autocomplete for SQL queries—make it easier to build type-safe Moose-backed experiences. Meanwhile, Boreal added infra maps and storage visualizations so teams can see how their systems are wired and how their data grows.

<Callout type="info" title="Highlights">
* **New:** [Arbitrary JSON fields in ingest APIs](#arbitrary-json-fields-in-ingest-apis) for flexible schema evolution
* **New:** [Kafka engine support](#kafka-engine-support-for-streaming-ingestion) for real-time ClickHouse ingestion
* **New:** [IcebergS3 engine](#icebergs3-engine-for-data-lake-storage) for Apache Iceberg data lake integration
* **New:** [Python LSP autocomplete](#python-lsp-autocomplete-for-sql-queries) for type-safe SQL queries
* **New:** [Fastify web app template](#fastify-web-app-template) with automatic async initialization
* **New:** [Boreal infrastructure map visualization](#boreal-infrastructure-map-visualization)
</Callout>

---

## Arbitrary JSON fields in ingest APIs

Accept payloads with extra fields beyond your defined schema while still validating known fields. Extra fields automatically pass through to streaming functions and land in a JSON column.

**Why it matters:** Schema flexibility without chaos. Teams can ship events even when they don't fully agree on every property yet. Known fields still get enforceable validation, while "extra" properties land in a JSON column for later exploration. This is ideal for product analytics, logging, and gradual schema evolution.

```typescript filename="app/ingest/models.ts" copy
// TypeScript: Use index signature to accept arbitrary fields
export type UserEventInput = {
  timestamp: DateTime;
  eventName: string;
  userId: Key<string>;
  [key: string]: any;  // Allows any additional properties
};
```

In Python, use `extra='allow'` in your Pydantic models to achieve the same flexibility.

PR: [#3047](https://github.com/514-labs/moosestack/pull/3047) | Docs: [Data models](/moose/data-models)

---

## Kafka engine support for streaming ingestion

Define tables with Kafka engine to consume streaming data directly from Kafka topics into ClickHouse, with materialized views to transform and route the data.

**Why it matters:** First-class streaming from Kafka. Kafka engine tables + materialized views mean you can go directly from Kafka → ClickHouse with Moose orchestrating the flow and transformations. This reduces glue code, keeps ingestion real-time, and standardizes how streaming pipelines are defined.

```typescript filename="app/ingest/kafka.ts" copy
// Create a Kafka engine table that consumes from a topic
export const KafkaSourceTable = new OlapTable<KafkaTestEvent>(
  "KafkaTestSource",
  {
    engine: ClickHouseEngines.Kafka,
    brokerList: "redpanda:9092",
    topicList: "KafkaTestInput",
    groupName: "moose_kafka_consumer",
    format: "JSONEachRow",
  },
);
```

PR: [#3066](https://github.com/514-labs/moosestack/pull/3066) | Docs: [OlapTable](/moose/olap)

---

## IcebergS3 engine for data lake storage

Configure tables to use Apache Iceberg format with S3 storage for better data lake integration and columnar storage capabilities.

**Why it matters:** Data lake integration without the glue. IcebergS3 enables columnar storage on S3 with Parquet or ORC format, AWS credential management, and compression options. This bridges Moose's real-time pipelines with existing data lake infrastructure for analytics workloads.

```typescript filename="app/tables/analytics_events.ts" copy
export const AnalyticsEventsTable = new OlapTable<AnalyticsEvent>(
  "AnalyticsEvents",
  {
    engine: ClickHouseEngines.IcebergS3,
    path: "s3://my-data-lake/analytics/events/",
    format: "Parquet",
    awsAccessKeyId: "{{ AWS_ACCESS_KEY_ID }}",
    awsSecretAccessKey: "{{ AWS_SECRET_ACCESS_KEY }}",
    compression: "zstd",
  },
);
```

PR: [#2978](https://github.com/514-labs/moosestack/pull/2978) | Docs: [OlapTable](/moose/olap)

---

## Custom PRIMARY KEY expressions

Define custom PRIMARY KEY expressions with hash functions and custom column ordering for optimized ClickHouse table performance.

**Why it matters:** Better data distribution and query performance. Custom PRIMARY KEY expressions let you use functions like `cityHash64` for better distribution in ClickHouse, beyond simple column-based keys. This is essential for high-cardinality data where default ordering isn't optimal.

```typescript filename="app/ingest/models.ts" copy
export const primaryKeyExpressionTable = new OlapTable<PrimaryKeyExpressionTest>(
  "PrimaryKeyExpressionTest",
  {
    primaryKeyExpression: "(userId, cityHash64(eventId))",
    orderByExpression: "(userId, cityHash64(eventId), timestamp)",
  },
);
```

PR: [#3031](https://github.com/514-labs/moosestack/pull/3031) | Docs: [OlapTable](/moose/olap)

---

## Python LSP autocomplete for SQL queries

Get IDE autocomplete when referencing table columns in Python f-strings using the new `MooseModel` class with `{Column:col}` format.

**Why it matters:** Type-safe SQL without typos. Python developers can now get autocomplete suggestions for column names when writing SQL queries, catching errors at development time rather than runtime. The `{Column:col}` format ensures proper SQL quoting.

```python filename="app/models/user_event.py" copy
from moose_lib import MooseModel

class UserEvent(MooseModel):
    user_id: int
    event_type: str
    timestamp: str

# IDE autocomplete works when typing UserEvent.user_id
query = f"SELECT {UserEvent.user_id:col}, {UserEvent.event_type:col} FROM user_events"
```

PR: [#3024](https://github.com/514-labs/moosestack/pull/3024) | Docs: [Python data models](/moose/data-models)

---

## Materialized columns in data models

Define materialized columns to automatically compute derived values at ingestion time—date extractions, hash functions, JSON transformations—without separate aggregations.

**Why it matters:** Cheaper, faster queries at scale. Materialized columns move expensive expressions into ingestion time so queries become simple scans over precomputed fields. This directly impacts infrastructure cost and query latency for time-series, metrics, and logs.

```typescript filename="app/ingest/models.ts" copy
export interface MaterializedTest {
  id: Key<string>;
  timestamp: DateTime;
  userId: string;
  // Materialized columns - computed at ingestion time
  eventDate: string & ClickHouseMaterialized<"toDate(timestamp)">;
  userHash: UInt64 & ClickHouseMaterialized<"cityHash64(userId)">;
}
```

PR: [#3051](https://github.com/514-labs/moosestack/pull/3051) | Docs: [Supported types](/moose/olap/supported-types)

---

## Per-column compression codecs

Specify compression codecs (ZSTD, LZ4, Delta, Gorilla) on individual columns to optimize storage and query performance for different data characteristics.

**Why it matters:** Per-column codecs let you tune storage/performance per field—Delta/Gorilla for time-series, higher ZSTD for logs. This directly impacts infrastructure cost and query latency.

```typescript filename="app/ingest/models.ts" copy
export interface CodecTest {
  id: Key<string>;
  timestamp: DateTime & ClickHouseCodec<"Delta, LZ4">;
  temperature: number & ClickHouseCodec<"Gorilla, ZSTD(3)">;
  log_blob: Record<string, any> & ClickHouseCodec<"ZSTD(3)">;
}
```

PR: [#3035](https://github.com/514-labs/moosestack/pull/3035) | Docs: [Supported types](/moose/olap/supported-types)

---

## Fastify web app template

New project template demonstrating Fastify framework with Moose, plus fixed WebApp support for Fastify's async initialization.

**Why it matters:** Fast path to production web APIs. The Fastify template + WebApp fix give a working, idiomatic example for building Moose-backed services. Fastify's performance and schema support pair nicely with Moose's data models, lowering the barrier for new services.

```typescript filename="app/apis/analytics.ts" copy
import Fastify from "fastify";
import { WebApp } from "@514labs/moose-lib";

const app = Fastify({ logger: true });
app.get("/health", async () => ({ status: "ok" }));

// Export as WebApp - Moose handles Fastify's ready() automatically
export const analyticsApp = new WebApp("analyticsApi", app, {
  mountPath: "/analytics",
});
```

PR: [#3068](https://github.com/514-labs/moosestack/pull/3068), [#3061](https://github.com/514-labs/moosestack/pull/3061) | Docs: [Fastify integration](/moose/app-api-frameworks)

---

## Next.js client-only mode

Enable `MOOSE_CLIENT_ONLY` environment variable so Next.js apps can import Moose data models without running the full runtime or fighting HMR errors.

**Why it matters:** Frontend type safety without runtime headaches. This solves "already exists" errors during Hot Module Replacement and supports a pattern where the frontend gets type-safe definitions while the heavy Moose runtime stays server-side where it belongs.

```javascript filename="next.config.js" copy
const nextConfig = {
  env: {
    MOOSE_CLIENT_ONLY: 'true', // Prevents duplicate registration errors during HMR
  },
}
```

PR: [#3057](https://github.com/514-labs/moosestack/pull/3057)

---

## Web apps in `moose ls`

The `moose ls` command now displays web applications alongside tables, streams, and APIs, making them first-class infrastructure citizens.

**Why it matters:** Web apps as first-class infra. Discover what UIs exist (admin dashboards, portals, analytics UI) and integrate this into tooling, scripts, or dashboards.

```bash filename="Terminal" copy
moose ls                      # List all components including web apps
moose ls --type web_apps      # Filter to show only web apps
moose ls --type web_apps --json  # JSON format for scripting
```

PR: [#3054](https://github.com/514-labs/moosestack/pull/3054) | Docs: [CLI reference](/moose/moose-cli)

---

## Other Moose improvements

- **Lifecycle inheritance in IngestPipeline** – Top-level lifecycle settings automatically propagate to table, stream, and deadLetterQueue components, reducing config duplication. PR [#3088](https://github.com/514-labs/moosestack/pull/3088)
- **MCP query result compression** – Results compressed using toon format for better IDE/AI integration performance. PR [#3033](https://github.com/514-labs/moosestack/pull/3033)
- **API key auth in MCP template** – Optional PBKDF2-based authentication for secure MCP server deployments. PR [#3053](https://github.com/514-labs/moosestack/pull/3053)
- **Latency logging for TypeScript APIs** – HTTP requests to consumption APIs now log response times in milliseconds for easier performance monitoring. PR [#3042](https://github.com/514-labs/moosestack/pull/3042)
- **Renamed --connection-string to --clickhouse-url** – CLI now uses `--clickhouse-url` for ClickHouse commands (old flag still works). Improved connection string parsing for native protocol URLs. PR [#3022](https://github.com/514-labs/moosestack/pull/3022)
- **No-ANSI output option** – Disable colored CLI output for CI/CD systems and log files. PR [#3044](https://github.com/514-labs/moosestack/pull/3044)
- **Faster CLI logging** – Optimized tracing implementation reduces memory allocations. PR [#3040](https://github.com/514-labs/moosestack/pull/3040), [#3041](https://github.com/514-labs/moosestack/pull/3041)
- **Documentation updates** – Improved quickstart, ClickHouse migration guide, and simplified installation command. PR [#3079](https://github.com/514-labs/moosestack/pull/3079), [#3073](https://github.com/514-labs/moosestack/pull/3073)
- **Hash-token output cleanup** – Cleaner, more concise `moose generate hash-token` output. PR [#3060](https://github.com/514-labs/moosestack/pull/3060)

## Moose bug fixes

- **Security updates in templates** – Updated Next.js (15.4.7 → 16.0.7) and React (19.0.0 → 19.0.1) to patch security vulnerabilities in frontend templates. [#3089](https://github.com/514-labs/moosestack/pull/3089)
- **MCP template build failures** – Fixed missing/empty `.npmrc` files that caused `npm install` and Docker builds to fail when creating new MCP server projects. [#3084](https://github.com/514-labs/moosestack/pull/3084), [#3082](https://github.com/514-labs/moosestack/pull/3082), [#3081](https://github.com/514-labs/moosestack/pull/3081)
- **MCP SDK compatibility** – Updated MCP template to work with SDK v1.23+ which changed its TypeScript types. Migrated to new `server.tool` API with Zod validation. [#3075](https://github.com/514-labs/moosestack/pull/3075)
- **MCP auth setup instructions** – Clarified authentication setup steps in the MCP template README. [#3058](https://github.com/514-labs/moosestack/pull/3058)
- **ORDER BY parsing with projections** – Fixed incorrect ORDER BY extraction when tables contain projections. The CLI was picking up projection ORDER BY clauses instead of the main table's. [#3052](https://github.com/514-labs/moosestack/pull/3052)
- **Zod import path in tests template** – Fixed broken import path that prevented TypeScript tests template from compiling. [#3038](https://github.com/514-labs/moosestack/pull/3038)
- **Array literals in views** – Views containing ClickHouse array syntax like `['a', 'b']` would fail to parse. Added fallback parser to handle ClickHouse-specific SQL. [#3034](https://github.com/514-labs/moosestack/pull/3034)
- **LowCardinality columns in peek/query** – `moose peek` and `moose query` failed on tables with `LowCardinality(String)` columns. Switched to HTTP-based ClickHouse client which supports all column types. [#3025](https://github.com/514-labs/moosestack/pull/3025)
- **DateTime precision preservation** – JavaScript Date objects drop microseconds/nanoseconds. Added `DateTimeString` and `DateTime64String<P>` types that keep timestamps as strings to preserve full precision. [#3018](https://github.com/514-labs/moosestack/pull/3018)

---

## Boreal: Infrastructure map visualization

View your deployed MooseStack architecture directly in the Boreal dashboard—services, data flows, and components in one place.

**Why it matters:** See your architecture, don't guess it. The infrastructure map helps with onboarding new teammates, debugging mis-wired components, and explaining the system to stakeholders.

---

## Boreal: Database storage visualization (experimental)

New experimental page showing table storage usage over time with interactive charts.

**Why it matters:** Watch storage growth over time. Time-series charts of table sizes are crucial for capacity planning, catching runaway growth, and understanding which workloads drive storage cost.

---

## Other Boreal Features and Improvements

- **Log drain performance** – Reuses database connections instead of creating new ones per batch, reducing connection overhead.
- **ClickHouse query performance** – Optimized table structure and indexing for faster loading of query performance data.
- **Temporarily removed "Build from Existing Database"** – Option removed from project creation flow while being improved. Users can still import from GitHub or templates.

---

## Infrastructure improvements

- **Extended deployment startup timeouts** – Increased from 60 to 180 seconds to reduce failures for larger applications during high-load periods.

---

## Boreal Bug Fixes

- **GitHub authentication** – Fixed issues preventing repository connections and operations.
- **Security updates** – React 19.2.0 → 19.2.1, Next.js 16.0.1 → 16.0.7.
- **Function names display** – Fixed missing function names in metrics table.
